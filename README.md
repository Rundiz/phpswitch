# PHPSwitch

Switch between PHP versions using command line on Windows.

## Requirement:
Windows 10 64 bit.<br>
.NET Framework 4.7.2<br>
Administrator privilege (Windows UAC).

## Installation

### Prepare folders
#### PHP versions folder
There is one folder that contain multiple PHP versions and this is required. This folder will be called **PHP versions folder**.

The **PHP versions folder** structure must follow this guide line.

* php *(Assume that this is PHP versions folder)*.
	* php7.3 *(Keep the version number after the text "php" in lower case, no space)*
		* dev
		* ext
		* *...*
		* php.ini
		* *..*
     * php7.4
     	* *...*
     * php8.0
       * *...*
	 * php-running *(Required folder, case sensitive)*

Each PHP versions folder must contain the files that you have downloaded from [php.net](https://php.net).

##### php-running folder
The **php-running** folder is required to make PHP works (CLI and web server).<br>
If you want to access `php` executable file, please add this **php-running** path into your **System variables** > **Path**.<br>
To do this, run `rundll32.exe sysdm.cpl,EditEnvironmentVariables` in the command line. Edit **Path** in **System variables** and then add the full path to **php-running** folder.

#### Apache folder
Another one is the folder that contain Apache but this is optional for who is using Apache only. This folder will be called **Apache folder**.

The **Apache folder** structure must follow this guide line.

* Apache24 *(24 represent Apache v2.4)*
	* bin
	* cgi-bin
	* conf
		* extra
			* *...*
			* httpd-php.conf *(This file is required if you use Apache.)*
			* httpd-php-7.3.conf *(Keep the version number after the text "php-" in lower case, no space)*
			* httpd-php-7.4.conf
			* httpd-php-8.0.conf
			* *...*
		* *...*
	* *...*

The file **httpd-php.conf** must be included in the **httpd.conf** file. The file **httpd-php-x.x.conf** (where x.x is the version of PHP) will be included in the **httpd-php.conf** file -  automatically generated by **PHPSwitch** application.

#### PHP + Apache (optional) + PHPSwitch
If you don't want to use **phpswitch.json** config file, this is the overall folders that should be together.
If you want to use the config file, please skip this step.

* apache
	* Apache24
		* bin
		* cgi-bin
		* conf
			* extra
			* *...*
        * *...*
* php
	* php7.3
	* php7.4
	* php8.0
	* *...*
	* php-running
* phpswitch
	* phpswitch.exe

#### Add Windows Environment Path

Add path that contain **phpswitch.exe** into your **System variables** > **Path**.

## Usage:
### Not using phpswitch.json
Open your command console and navigate to the folder that contain **apache**, **php**, **phpswitch** as described above.

Run `phpswitch` command and follow with version number. Example: `phpswitch 7.4` to switch to PHP 7.4.

![PHPSwitch Screenshot](.web-assets/phpswitch0.1-screenshot-01.jpg)

#### Run with different php versions folder or different Apache folder location.

If you have **PHP versions folder** or **Apache folder** on different location, please use the following command.

```
phpswitch 7.4 C:\myphp-versions
```
The above command will be use any phpx.x folders inside **C:\myphp-versions**

```
phpswitch 8.0 C:\myphp-versions C:\myapache\Apache2.4
```
The above command has additional path to Apache folder. This folder must contain **conf** folder in it.

### Use phpswitch.json

**phpswitch.json** is configuration file that allow you to have different **PHP versions folder** and **Apache folder** location. It is also allow you to control update Apache config file, start or stop service name, or copy additional folders and files.

#### Example of phpswitch.json
```json
{
  "phpVersionsDir": "D:\\wwwserver-x64\\php",
  "webserverServiceName": "apache",
  "apacheDir": "D:\\wwwserver-x64\\apache\\Apache24",
  "apacheUpdateConfig": true,
  "additionalCopy": {
    "7.0": [
      {
        "copyFromDir": "D:\\ImageMagick\\6.9.3-7-vc14-x64\\bin",
        "searchPattern": "CORE_*.dll",
        "copyTo": "."
      },
      {
        "copyFromDir": "D:\\ImageMagick\\6.9.3-7-vc14-x64\\bin",
        "searchPattern": "IM_*.dll",
        "copyTo": "."
      }
    ],
    "7.1": [
      {
        "copyFromDir": "D:\\ImageMagick\\6.9.3-7-vc14-x64\\bin",
        "searchPattern": "CORE_*.dll",
        "copyTo": "."
      },
      {
        "copyFromDir": "D:\\ImageMagick\\6.9.3-7-vc14-x64\\bin",
        "searchPattern": "IM_*.dll",
        "copyTo": "."
      }
    ]
  },
  "_comment": "Copy and paste this file into the folder you want to run the `phpswitch` command. Modify path above to your real path. Then run the `phpswitch` command without php and apache arguments."
}
```
To skip start, stop the service. Set `webserverServiceName` to empty.<br>
To start, stop multiple services that contains same name such as Apachex86, Apachex64. Set `webserverServiceName` to `apache`.

If `apacheUpdateConfig` is set to `false` then the Apache config file will not gets updated.

The `additionalCopy` must contains PHP version number as key (or property) and the list of copy files as array. For more information about `searchPattern`, please read on [.Net document](https://docs.microsoft.com/en-us/dotnet/api/system.io.directory.getdirectories?view=net-5.0#System_IO_Directory_GetDirectories_System_String_System_String_)

The `copyTo` is related path to **php-running** folder.

#### Run phpswitch with config file.

It is important to run **phpswitch** with configuration file, you must run it from the folder that contain **phpswitch.json** file and you'll see a result like this.

> Found phpswitch.json file, it is now using configuration from this file.